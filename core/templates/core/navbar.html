<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm py-3 mb-4">
  <div class="container d-flex justify-content-between align-items-center">
    <a class="navbar-brand fw-bold text-primary" href="{% url 'feed' %}">
      <i class="bi bi-chat-square-dots-fill"></i> SocialSphere
    </a>

    <!-- Search + Notifications -->
    <div class="d-flex align-items-center me-3 position-relative">
      <!-- Search Icon -->
      <div class="position-relative me-3">
        <i id="searchIcon" class="bi bi-search fs-4" style="cursor:pointer;"></i>
        <div id="searchContainer" class="d-none position-absolute p-2 bg-white shadow rounded"
          style="top: 35px; right: 0; width: 350px; max-height: 400px; overflow-y: auto; z-index: 1000;">
          <input type="text" id="searchInput" placeholder="Search users..." class="form-control mb-2"
            style="width: 100%; border-radius: 25px; padding: 8px 15px;">
          <div id="searchResults"></div>
        </div>
      </div>

      <!-- Notifications -->
      <div class="position-relative">
        <i id="notificationsIcon" class="bi bi-bell fs-4" style="cursor:pointer;"></i>
        <ul id="notificationList" class="position-absolute bg-white shadow rounded p-2"
          style="top: 35px; right: 0; width: 250px; max-height: 300px; overflow-y: auto; display: none; z-index: 1000;">
        </ul>
        <span id="notificationBadge"
          class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
          style="font-size: 0.6rem; display: none;">0</span>
      </div>
    </div>

    <!-- User Dropdown -->
    <div class="d-flex align-items-center">
      {% if user.is_authenticated %}
      <div class="dropdown">
        <button class="btn dropdown-toggle d-flex align-items-center border-0 bg-transparent" type="button"
          id="userMenu" data-bs-toggle="dropdown" aria-expanded="false">
          <img src="https://ui-avatars.com/api/?name={{ user.username }}&background=764ba2&color=fff&rounded=true"
            alt="User Avatar" class="rounded-circle me-2" width="40" height="40">
        </button>
        <ul class="dropdown-menu dropdown-menu-end shadow border-0 rounded-3" aria-labelledby="userMenu">
          <li class="dropdown-header text-center"><strong>{{ user.username }}</strong></li>
          <li>
            <hr class="dropdown-divider">
          </li>
          <li><a class="dropdown-item" href="{% url 'profile' user.username %}"><i class="bi bi-person me-2"></i>My
              Profile</a></li>
          <li><a class="dropdown-item" href="{% url 'my_posts' %}"><i class="bi bi-postcard me-2"></i>My Posts</a></li>
          <li>
            <hr class="dropdown-divider">
          </li>
          <li><a class="dropdown-item text-danger" href="{% url 'logout' %}"><i
                class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
        </ul>
      </div>
      {% else %}
      <a href="{% url 'login' %}" class="btn btn-outline-primary btn-sm me-2">Login</a>
      <a href="{% url 'register' %}" class="btn btn-primary btn-sm">Register</a>
      {% endif %}
    </div>
  </div>
</nav>

<!-- Attach JS only once -->
{% include 'core/navbar_scripts.html' %}